tag:
priority: 210

type: txt

syntax:expression: pattern $VAR(@) "^[[:graph:]]{1,29}$" ; \
                   "Firewall name must be 29 characters or less"
syntax:expression: pattern $VAR(@) "^[^-]" ; \
                   "Firewall rule set name cannot start with \"-\""
syntax:expression: pattern $VAR(@) "^[^|;&$<>]*$" ; \
                   "Firewall rule set name cannot contain shell punctuation"
syntax:expression: ! pattern $VAR(@) "^VZONE" ; \
                   "Firewall rule set name cannot start with 'VZONE'"

end: if sudo /opt/vyatta/sbin/vyatta-firewall.pl --update-rules ipv6-name "$VAR(@)" ;
     then
       if [ ${COMMIT_ACTION} = 'DELETE' ] ; 
       then
          if sudo /opt/vyatta/sbin/vyatta-firewall.pl --teardown-ok ipv6-name ; 
          then
             sudo /opt/vyatta/sbin/vyatta-firewall.pl --teardown ipv6-name
          fi
       fi
     else
       exit 1;
     fi

create: sudo /opt/vyatta/sbin/vyatta-firewall.pl --setup ip6tables ipv6-name

help: Set IPv6 firewall rule set name
